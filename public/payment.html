<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment</title>
</head>
<body>
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact</title>
    <link rel="stylesheet" href="payment.css">
</head>
<body>
    <header>
        <div class="logo-container">
            <img src="assets/logo.png" alt="Logo">
            <span>MrApers</span>
        </div>
        <div class="button-container">
            <a href="index.html">
            <button>
                <img src="assets/rarrow.svg" alt="Wave Icon">
                Go Back
            </button>
        </a>
        </div>
    </header>
    <section class="profile">
        <img src="assets/rarrow2.svg" alt="go back" class="go-back">
        <h4><a href="index.html" class="dont">Go Back</a></h4>
    </section>
    <main>
        <h1>Funding me is a <span>Mistake</span>!</h1>
        <p>But from mistakes we learn!</p>
        <form id="payment-form" class="contact-form">
            <div class="input-container">
                <input type="text" id="first-name" name="first-name" required placeholder=" ">
                <label for="first-name">Full Name</label>
            </div>
            <div class="input-container">
                <input type="email" id="email-address" name="email-address" required placeholder=" ">
                <label for="email-address">Email Address</label>
            </div>
            <div class="input-container">
                <input type="number" id="amount" name="amount" required placeholder=" " min="1">
                <label for="amount">Amount ($)</label>
            </div>
            <div class="input-container">
                <select id="payment-type" name="payment-type" required>
                    <option value="" disabled selected hidden>Select Payment Type</option>
                    <option value="applepay" data-icon="applepay.svg">Apple Pay</option>
                    <option value="paypal" data-icon="paypal.svg">PayPal</option>
                    <option value="mastercard" data-icon="mastercard.svg">Mastercard</option>
                    <option value="googlepay" data-icon="googlepay.svg">Google Pay</option>
                </select>
                <label for="payment-type">Payment Type</label>
                <div id="payment-icon-container"></div>
            </div>
            <h3>Your funding is highly appreciated!</h3>
            <img src="assets/arrow2.svg" alt="Arrow Icon" class="small-arrow">
            <button type="submit" id="submit-button" class="submit-button">Proceed</button>
        </form>
        <div id="paypal-button-container"></div>

    </main>
    <div class="about-content">
        <div class="gradient-top"></div>
    <h2><strong>You May<span class="highlight"> Ask</span> Yourself</strong></h2>
    <div class="dropdown">
        <button class="dropdown-btn">
            <span class="dropdown-number"><strong>1</strong></span>
            <strong>Will I ever see my money back?</strong>
            <img src="assets/down.svg" alt="Down Icon" class="dropdown-icon">
        </button>
        <div class="dropdown-content">
            <p>Details about this question go here. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
        </div>
    </div>
    <div class="dropdown">
        <button class="dropdown-btn">
            <span class="dropdown-number"><strong>2</strong></span>
            <strong>Can I track my money?</strong>
            <img src="assets/down.svg" alt="Down Icon" class="dropdown-icon">
        </button>
        <div class="dropdown-content">
            <p>Details about tracking your money go here. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
        </div>
    </div>
    <div class="dropdown">
        <button class="dropdown-btn">
            <span class="dropdown-number"><strong>3</strong></span>
            <strong>Why would I give any money?</strong>
            <img src="assets/down.svg" alt="Down Icon" class="dropdown-icon">
        </button>
        <div class="dropdown-content">
            <p><strong>Placeholder text for item 3.</strong></p>
        </div>
    </div>
    <div class="dropdown">
        <button class="dropdown-btn">
            <span class="dropdown-number"><strong>4</strong></span>
            <strong>Can I help in another way?</strong>
            <img src="assets/down.svg" alt="Down Icon" class="dropdown-icon">
        </button>
        <div class="dropdown-content">
            <p><strong>Placeholder text for item 4</strong></p>
        </div>
    </div>
    <div class="dropdown">
        <button class="dropdown-btn">
            <span class="dropdown-number"><strong>5</strong></span>
            <strong>placeholder</strong>
            <img src="assets/down.svg" alt="Down Icon" class="dropdown-icon">
        </button>
        <div class="dropdown-content">
            <p><strong>Placeholder text for item 4</strong></p>
        </div>
    </div>
    <div class="dropdown">
        <button class="dropdown-btn">
            <span class="dropdown-number"><strong>6</strong></span>
            <strong>Placeholder</strong>
            <img src="assets/down.svg" alt="Down Icon" class="dropdown-icon">
        </button>
        <div class="dropdown-content">
            <p><strong>Placeholder text for item 4</strong></p>
        </div>
    </div>

    <div class="gradient-bottom"></div>
    </div>
    <footer class="footer">
        <hr class="footer-divider">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="assets/logo.png" alt="Logo">
                <span class="footer-logo-text"><strong>MrApers</strong></span>
            </div>
            <div class="footer-links">
                <a href="story.html" class="footer-link"><strong>My Story</strong></a>
                <a href="privacypolicy.html" class="footer-link"><strong>Privacy Policy</strong></a>
                <a href="sms:+32472216683" class="footer-link"><strong>Phone</strong></a>
                <a href="mailto:casper.apers@gmail.com" class="footer-link"><strong>Email</strong></a>
                <a href="https://www.linkedin.com/in/mr-apers-bb6720317/" class="footer-link" target="_blank"><strong>LinkedIn</strong></a>
            </div>
            <p class="footer-description">
                This website was created for demo purposes only to showcase Adobe XD. Site content by Dani Beaumont, with images by Traci L. Clever Photography and site design by Dani Beaumont and QooQee.com. All rights reserved.
            </p>
        </div>
    </footer>
    <script src="https://www.paypal.com/sdk/js?client-id=Ac7FG6uhON8wOx6FhPpFl3M3K1m4PUVhiSXiEGBkwzmV6Pfy9H_kp-idK8MSFD2hMVzqkc-USSEtQiwT&components=buttons"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script>

document.addEventListener('DOMContentLoaded', function () {
    document.getElementById('payment-type').addEventListener('change', function () {
        const selectedValue = this.value;
        const paymentIconContainer = document.getElementById('payment-icon-container');
        
        // Clear any previous icons
        paymentIconContainer.innerHTML = '';
        
        // Get the icon from the selected option
        const selectedOption = this.options[this.selectedIndex];
        const iconName = selectedOption.getAttribute('data-icon');
        
        // Create and display the new icon
        const iconImage = document.createElement('img');
        iconImage.src = `assets/${iconName}`;
        iconImage.alt = selectedValue;
        iconImage.classList.add('payment-icon'); // Optionally add a class for styling
        paymentIconContainer.appendChild(iconImage);
    });
});


document.getElementById('payment-form').addEventListener('submit', async function (e) {
    e.preventDefault(); // Prevent form refresh

    try {
        const amount = document.getElementById('amount').value;

        if (amount <= 0) {
            alert('Please enter a valid amount.');
            return;
        }

        // Make sure the URL matches the backend's correct endpoint
        const response = await fetch('https://mr-apers.koyeb.app/create-checkout-session', { 
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                amount: amount * 100, // Convert dollars to cents
                name: document.getElementById('first-name').value,
                email: document.getElementById('email-address').value,
            }),
        });

        if (!response.ok) {
            throw new Error('Failed to create checkout session');
        }

        const { url } = await response.json();
        window.location.href = url; // Redirect to the Stripe Checkout page
    } catch (error) {
        console.error('Error:', error);
        alert('Something went wrong. Please try again.');
    }
});

document.getElementById('payment-type').addEventListener('change', function () {
    const selectedValue = this.value;
    const icons = document.querySelectorAll('.payment-icon');

    icons.forEach(icon => {
        if (icon.dataset.payment === selectedValue) {
            icon.classList.add('active');
        } else {
            icon.classList.remove('active');
        }
    });

    // Show PayPal button when PayPal is selected
    if (selectedValue === 'paypal') {
        showPayPalButton();
    } else {
        hidePayPalButton();
    }
});

function showPayPalButton() {
    const paypalContainer = document.getElementById('paypal-button-container');
    if (!paypalContainer) {
        const newContainer = document.createElement('div');
        newContainer.id = 'paypal-button-container';
        document.getElementById('payment-form').appendChild(newContainer);
    }

    // Render the PayPal button
    paypal.Buttons({
        createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: document.getElementById('amount').value
                    }
                }]
            });
        },
        onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
                alert('Transaction completed by ' + details.payer.name.given_name);
                // Handle success here
            });
        },
        onError: function(err) {
            console.error(err);
            alert('Something went wrong with PayPal. Please try again.');
        }
    }).render('#paypal-button-container');
}

function hidePayPalButton() {
    const paypalContainer = document.getElementById('paypal-button-container');
    if (paypalContainer) {
        paypalContainer.innerHTML = ''; // Remove PayPal button
    }
}

        document.addEventListener("DOMContentLoaded", () => {
    const dropdownButtons = document.querySelectorAll(".dropdown-btn");

    dropdownButtons.forEach((button) => {
        button.addEventListener("click", () => {
            const dropdown = button.closest(".dropdown"); // Get the parent .dropdown container
            const dropdownContent = dropdown.querySelector(".dropdown-content");

            // Toggle 'open' class on dropdown-content
            dropdownContent.classList.toggle("open");

            // Toggle 'active' class on the button for icon rotation
            button.classList.toggle("active");

            // Adjust the parent dropdown height if needed
            dropdown.style.height = dropdownContent.classList.contains("open")
                ? `${dropdown.scrollHeight}px`
                : '';
        });
    });
});

    </script>
    
</body>
</html>
